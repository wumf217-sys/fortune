<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>8 - Fortune</title>

<style>
body{font-family:-apple-system,system-ui; margin:0; background:#111; color:#fff;}
.wrap{max-width:900px; margin:0 auto; padding:18px;}
h1{font-size:20px; margin:6px 0 14px;}
label{font-size:14px; opacity:.9}
input{width:100%; padding:10px; border-radius:10px; border:0; margin:6px 0 14px;}
button{width:100%; padding:14px; border-radius:14px; border:0; font-size:16px; font-weight:600; background:#19c37d; color:#000}
.tabs{display:none; margin-top:14px;}
.tab-buttons{display:grid; grid-template-columns:1fr 1fr; gap:8px;}
.tab-buttons button{background:#333; color:#fff}
.tab-buttons button.active{background:#19c37d; color:#000}
.tab-content{margin-top:12px; line-height:1.65}
.hidden{display:none}
</style>
</head>

<body>
<div class="wrap">

<div id="start">
<h1>8 – あなたを読み解く旅</h1>

<label>名前</label>
<input id="name" placeholder="未入力でもOK">

<label>生年月日</label>
<input id="birthday" type="date">

<button id="go">占う</button>
</div>

<div id="result" class="hidden">
<h1 id="title"></h1>

<div class="tabs">
  <div class="tab-buttons" id="tabBtns"></div>
  <div class="tab-content" id="tabBody"></div>
</div>
</div>

</div>

<script>
// ★ フォーム submit を使わない（iPhoneで止まる原因を排除）
document.getElementById("go").addEventListener("click", runFortune);

function runFortune(){
  const n = (document.getElementById("name").value || "あなた").trim();
  const b = document.getElementById("birthday").value || "2000-01-01";

  // ★ iOS未確定対策：常に安全にパース
  const t = new Date(b + "T00:00:00").getTime();
  const num = ((t/86400000)|0) % 8; // 0〜7

  const type = (num+1); // 1〜8

  // ---- ここから簡易分岐（仮テキスト：後で厚くする前提） ----
  const core = {
    1:"外へ向かう推進力。責任と行動によって道を押し開くタイプ。",
    2:"つながりと調和。人の気持ちを感じ、関係性を編むタイプ。",
    3:"ひらめきと遊び心。発想で流れを軽くするタイプ。",
    4:"土台と安定。形づくり・仕組み化で積み上げるタイプ.",
    5:"変化と自由。停滞を風に変える突破タイプ。",
    6:"育てる力。守り・整え・バランスを戻すタイプ。",
    7:"洞察と探求。静かな集中で核心に迫るタイプ。",
    8:"統合と循環。内外を行き来しながら力を束ねるタイプ。"
  };

  const tabs = [
    {t:"あなたの核", c: `${n}さんの核は「${type}の性質」。${core[type]}`},
    {t:"表と裏", c:"表ではこう振る舞い、裏側ではこう受け止めている——という二層性を持っています。（ここに本編が入ります）"},
    {t:"運気の流れ", c:"これまで／今／これから——同じ出来事を違う角度から見直すと意味が変わります。"},
    {t:"才能の使い方", c:"8つの才能は誰の中にもあり、その配分と扱い方によって人生の軌道は変わります。"},
    {t:"使命と課題", c:"避けてきたテーマの中に、次の成長の入口があります。"},
    {t:"まとめ", c:"ここで得た視点は「正解」ではなく、見直すための光です。必要なところから静かに使ってください。"}
  ];

  // ---- 画面切替 ----
  document.getElementById("start").classList.add("hidden");
  const res = document.getElementById("result");
  res.classList.remove("hidden");
  document.getElementById("title").textContent = `${n}さんの読み解き`;

  buildTabs(tabs);
}

function buildTabs(list){
  const btns = document.getElementById("tabBtns");
  const body = document.getElementById("tabBody");
  btns.innerHTML = "";
  body.innerHTML = "";

  list.forEach((tab,i)=>{
    const b = document.createElement("button");
    b.textContent = tab.t;
    b.onclick = ()=>selectTab(i,list);
    btns.appendChild(b);
  });

  document.querySelector(".tabs").style.display="block";
  selectTab(0,list);
}

function selectTab(i,list){
  const btns = [...document.querySelectorAll("#tabBtns button")];
  btns.forEach(b=>b.classList.remove("active"));
  btns[i].classList.add("active");
  document.getElementById("tabBody").textContent = list[i].c;
}
</script>
</body>
</html>
